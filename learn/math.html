<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <link rel="stylesheet" href="../style.css">
    <link rel="icon" type="image/x-icon" href="../img/logo.png">
    <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
    <meta name="msapplication-TileColor" content="#FFFFFF">
    <meta name="description" content="Flace(cards) est un site d’apprentissage fondé sur l’utilisation de flashcards préparées aux préalable dans toutes les matières. Le site s’adapte à ses utilisateurs via un système de piles inspiré de la méthode Leitner, permettant un apprentissage durable (prouvé scientifiquement). FlaceCards, Long-term learning.">
</head>
<body>
    <style>
      /* code pour s'adapter au petit ecrans/ telephone */
    @media screen and (max-width: 700px) {
      .flashcard {
        width: 320px;
        height: 180px;
        left: calc(50% - 160px);
      }
      .searchcard {
    height: 40px;
    width: 80%;
  }
  #next {
    margin-top: 50px;
    right: 50px;
  }
  #prev {
    margin-top: 50px;
    left: 50px;
  }
  .slider i {
    font-size: 50px;
  }
  .modal img {
  position: absolute;
  height: auto;
  width: 100%;
}
.flashcard h2 {
  font-style: italic;
  font-size: 20px;
  margin-left: 10px;
  color: #000;
  font-weight: 400;
}
.flashcard h5 {
  text-align: center;
  font-weight: 700;
  font-size: 20px;
  color: #000;
}
    }
    @media screen and (max-width: 450px) {
.modal-header .title {
  width: 300px;
  text-align: center;
  font-size: 15px;
  font-weight: 600;
  color: var(--text-color);
}
.content {
  width: 90%;
  position: absolute;
  font-weight: 400;
  color: var(--text-color);
  font-size: 20px;
  text-align: center;
  margin: 20px;
}
    }
    </style>
    <div class="home">
       <!-- searchbar -->
      <div class="searchsection">
            <div class="searchcard">
                <i class='bx bx-search'></i>
                <input type="text" id="searchInput" onkeyup="searchFunction()" placeholder="Rechercher une flashcard...">
            </div>
        </div>
        <!-- container des flashcards -->
        <div class="cards" id="cardscontainer"></div>
        <!-- container des flashcards random en grande-->
        <div id="cardslider" class="slider">
        </div>
        
     </div>
    </div>

    <!-- popup -->
    <div class="modal" id="modal">
        <div class="modal-header">
          <div id="popuptitle" class="title"></div>
          <i id="closebutton" data-close-button class="bx bx-x close-button"></i>
        </div>
        <div class="modal-body">
            <div id="popupcontent" class="content">
        
            </div>
            <img id="popupimg" src="">
    
        </div>
      </div>   
      <div class="modal" id="modal2">
        <div class="modal-header">
          <div id="popuptitle2" class="title"></div>
          <i id="closebutton" data-close-button class="bx bx-x close-button"></i>
        </div>
        <div class="modal-body">
            <div id="popupcontent2" class="content">
        
            </div>
            <img id="popupimg2" src="">
    
        </div>
      </div>   
    <!-- overlay du popup pour le flou et pour detecter le clique dehors -->
    <div id="overlay" class="overlay"></div>
    <div id="overlay2" class="overlay"></div>
    <script>
        function setuppopup(popuptitle, popupcontent, img){
            document.getElementById('popuptitle').innerHTML = popuptitle
            document.getElementById('popupcontent').innerHTML = popupcontent
            document.getElementById('popupimg').src = img
              document.getElementById('modal').classList.add('active')
              document.getElementById('overlay').classList.add('active')
        }
        function setuppopup2(popuptitle, popupcontent, img){
            document.getElementById('popuptitle2').innerHTML = popuptitle
            document.getElementById('popupcontent2').innerHTML = popupcontent
            document.getElementById('popupimg2').src = img
              document.getElementById('modal2').classList.add('active')
              document.getElementById('overlay2').classList.add('active')
        }
    </script>
    <script>
      var input = document.getElementById("searchInput");
      input.addEventListener("input", function() {
  if (input.value == "") {
    document.getElementById('cardscontainer').style.display = 'none'
    document.getElementById('cardslider').style.display = 'flex'
  } else {
    document.getElementById('cardscontainer').style.display = 'flex'
    document.getElementById('cardslider').style.display = 'none'
  }
});

    </script>
    <script>
      function searchFunction() {
          let input = document.getElementById('searchInput');
          let filter = input.value.toUpperCase();
          let cards = document.getElementsByClassName('card');
          for (i = 0; i < cards.length; i++) {
              let title = cards[i].getElementsByTagName('h5')[0];
              let type = cards[i].getElementsByTagName('h2')[0];
              let seq = cards[i].getElementsByTagName('h3')[0];
              let txtValue = title.textContent || title.innerText;
              let typeValue = type.textContent || type.innerText;
              let seqnameValue = seq.textContent || seq.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1 || typeValue.toUpperCase().indexOf(filter) > -1 || seqnameValue.toUpperCase().indexOf(filter) > -1) {
                  cards[i].style.display = "";
                } else {
                    cards[i].style.display = "none";
                }
          }
        
      }
          </script>
    <!-- code pour fetch le json et creer une flashcard -->
    <script>
        // Le code recupère les données depuis le .json
        const jsonUrl = './api/math.json';
        fetch(jsonUrl).then(response => response.json()).then(data => {
        
          const cardscontainer = document.getElementById('cardscontainer');
          const cardslider = document.getElementById('cardslider');
          const rendercards = (cards) => {
            // quand il a recup les données, il crée des flashcards
            cards.forEach(cards => {
              const card = document.createElement('div');
              const innercard = document.createElement('div');
              const type = document.createElement('h2');
              const title = document.createElement('h5');
              const seq = document.createElement('h3');

              
              title.innerHTML = cards.title.toUpperCase()
              type.innerHTML = cards.type + ' :'
              seq.innerHTML = cards.seqname
              card.setAttribute('onclick', `setuppopup2('${cards.title}', '${cards.content}', '${cards.img}')`)
              card.classList.add('card');
              innercard.classList.add('innercard');
              

              cardscontainer.appendChild(card)
              card.appendChild(innercard);
              innercard.appendChild(seq);
              innercard.appendChild(type);
              innercard.appendChild(title);
              
              
              const flashcard = document.createElement('div');
              const innerflashcard = document.createElement('div');
              const flashtype = document.createElement('h2');
              const flashtitle = document.createElement('h5');
              const flashseq = document.createElement('h3');
              const flashseqname = document.createElement('h4');
              
              flashseq.innerHTML = "T" + cards.theme + "S" + cards.sequence
              flashseqname.innerHTML = cards.seqname
              flashcard.classList.add('flashcard')
              flashcard.setAttribute('onclick', `setuppopup('${cards.title}', '${cards.content}', '${cards.img}')`)
              innerflashcard.classList.add('innerflashcard')
              flashtitle.innerHTML = cards.title.toUpperCase()
              flashtype.innerHTML = cards.type + ' :'

              cardslider.appendChild(flashcard);
              flashcard.appendChild(innerflashcard);
              innerflashcard.appendChild(flashseq);
              innerflashcard.appendChild(flashseqname);
              innerflashcard.appendChild(flashtype);
              innerflashcard.appendChild(flashtitle);

              // Le code du slider
              let items = document.querySelectorAll('.slider .flashcard');
let active = 0;
function loadShow(){
    items[active].style.transform = `none`;
    items[active].style.zIndex = 1;
    items[active].style.filter = 'none';
    items[active].style.opacity = 1;
    // show after
    let stt = 0;
    for(var i = active + 1; i < items.length; i ++){
        stt++;
        items[i].style.transform = `translateX(${0*stt}px) scale(${1 - 0.2*stt}) perspective(30px) rotateY(-1deg)`;
        items[i].style.zIndex = -stt;
        items[i].style.filter = 'blur(5px)';
        items[i].style.opacity = stt > 2 ? 0 : 0.6;
    }
     stt = 0;
    for(var i = (active - 1); i >= 0; i --){
        stt++;
        items[i].style.transform = `translateX(${0*stt}px) scale(${1 - 0.2*stt}) perspective(30px) rotateY(1deg)`;
        items[i].style.zIndex = -stt;
        items[i].style.filter = 'blur(5px)';
        items[i].style.opacity = stt > 2 ? 0 : 0.6;
    }
}
loadShow();
let next = document.getElementById('closebutton');
let next2 = document.getElementById('overlay');
next.onclick = function(){
   active = active + 1 < items.length ?  active + 1 : active;
   loadShow();
}
next2.onclick = function(){
   active = active + 1 < items.length ?  active + 1 : active;
   loadShow();
   
}

            });
          };
          rendercards(data);
        }).catch(error => console.error('Error fetching cards:', error));
      </script>
      
      <!-- js du modal -->
    <script src="../js/modal.js"></script>
    <!-- js du truc au mileu les flashcards -->
</body>
</html>